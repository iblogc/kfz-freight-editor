# 孔夫子旧书网 - 批量修改运费模板工具产品说明书

## 1. 产品概述
本工具旨在解决孔网卖家在调整经营策略时，需要根据商品价格区间大规模、批量修改“出售中”商品运费模板的痛点。通过自动化流程，极大提高了店铺管理效率。

## 2. 核心技术特性
- **流式数据处理 (Scalable Architecture)**:
    - **获取阶段**: 采用流式写入技术，每抓取一页商品数据立即落盘，不堆积内存。
    - **处理阶段**: 采用分块读取技术，支持对包含数十万条记录的超大 CSV 文件进行稳定处理。
- **高可靠性**: 使用 `.tmp` 临时文件原子写入机制，确保在程序异常中断时，原始抓取数据不损坏、不丢失。
- **智能统计**: 自动识别 API 返回结果，生成包含成功/失败计数、价格区间详情、总耗时在内的任务摘要。
- **跨平台兼容**: 界面固定配色，支持 Windows 系统下的 `utf-8-sig` 编码，确保 Excel 打开不乱码。

## 3. 功能模块说明

### 3.1 模板选择
- 用户通过 CSV 文件定义修改规则。
- 格式要求：`价格下限,价格上限,运费模板名字`。
- 程序会自动校验模板中的“运费模板名字”是否与当前店铺已配置的模板完全匹配。

### 3.2 自动化执行流程
1. **登录验证**: 自动处理登录并维持 Session。
2. **规则匹配**: 按照 CSV 定义的价格区间，分批次搜索店铺内的商品。
3. **本地存档**: 在 `output/` 目录下为每次任务创建独立文件夹，保存包含商品 itemId、itemSn、price 等信息的原始清单。
4. **批量更新**: 联调孔网卖家后台接口，以 200 条/批次的速度进行修改，并实时记录每一行的处理结果（成功/失败）。

### 3.3 日志与反馈
- **实时控制台**: 区分 INFO、WARNING、ERROR 三种级别的日志颜色。
- **任务摘要**: 执行结束后在界面和结果文本中同步输出汇总数据。

## 4. 使用指南

### 4.1 准备工作
- 确保电脑已安装 Python 运行环境或已获得打包后的可执行文件。
- 准备好符合规范的 `运费修改模板.csv`。

### 4.2 操作步骤
1. 打开程序，点击 **“浏览...”** 选择您的修改模板 CSV。
2. 输入孔夫子旧书网的 **“账号”** 和 **“密码”**。
3. 点击 **“开始执行”**。此时界面输入框将被锁定以防误操作。
4. 观察右侧日志，等待弹出“完成”提示。
5. 点击 **“打开输出目录”** 查看详细的处理结果和汇总报告。

## 5. 常见问题排查
- **登录失败**: 请检查网络连接或账号密码是否正确。
- **列名缺失**: 请确保 CSV 模板的表头严格遵循 `价格下限,价格上限,运费模板名字`。
- **模板名不匹配**: 程序会提示具体哪个模板名字在店铺中找不到，请登录孔网后台检查模板名是否包含特殊空格或格式。

---
*本工具仅供孔网卖家辅助管理使用，请在法律法规及平台规则范围内操作。*
